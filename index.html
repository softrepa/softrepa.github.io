<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="SoftREPA"/>
  <meta property="og:description" content="Project Page for SoftREPA"/>
  <meta property="og:url" content="softrepa.github.io"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/figures/banner.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="SoftREPA">
  <meta name="twitter:description" content="Project Page for SoftREPA">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/figures/banner.png">
  <meta name="twitter:card" content="Project Page for SoftREPA">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>SoftREPA</title>
  <link rel="icon" type="image/x-icon" href="">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>

  <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
    </script>
    <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
  </script>

  <script
  defer
  src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js"
  ></script>
  <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css"
  />

  <style>
  .eps_null {
    color: rgb(53, 144, 243);
  }
  .eps_cfg {
    color: rgb(231, 111, 81);
  }
  .softrepa{
    color: rgb(42, 157, 143);
  }

  hr.solid {
  border-top: 2px solid #bbb;
  }

  table, td, th {
  border: 1px solid black;
  }

  table {
    border-collapse: collapse;
    width: 100%;
  }

  td {
    text-align: center;
    vertical-align: middle;
  }

  </style>

</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title"><span class="softrepa">SoftREPA</span>: Aligning Text to Image in Diffusion Models is Easier Than You Think</h1>
            <p>A lightweight and flexible contrastive learning method to improve text-image alignment in diffusion models.</p>
            <div class="is-size-4 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://www.linkedin.com/in/jaa-yeon-lee-21a892193/" target="_blank">Jaa-Yeon Lee</a><sup>*</sup>,</span>
                <span class="author-block">
                  <a href="https://sites.google.com/view/byungheecha/home" target="_blank">Byunhee Cha</a><sup>*</sup>,</span>
                   <span class="author-block">
                    <a href="https://jeongsol.dev/" target="_blank">Jeongsol Kim</a>,</span>
                    <span class="author-block">
                    <span class="author-block"> 
                      <a href="https://scholar.google.com/citations?user=HNMjoNEAAAAJ&hl=en" target="_blank">Jong Chul Ye</a></span>
            </div> 
              <div class="is-size-4 publication-authors">
                <span class="author-block" style="color:black"> KAIST </span>
                  <!-- <br>Conferance name and year</span> -->
                <span class="eql-cntrb" style="color:black"><small><br><sup>*</sup>Indicates Equal Contribution</small></span>
              </div>
          
                  <!-- PDF Link -->
                  <!-- <span class="link-block">
                    <a href="static/pdfs/softrepa.pdf" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    </ARXIV>
                    <span class="icon">
                      <i class="fas fa-file-pdf "></i>
                    </span>
                    <span>PDF</span>
                  </a>
                  </span> -->

                  <span class="link-block">
                    <!-- <a href="https://arxiv.org/abs/2406.08070" target="_blank" -->
                    <a target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    </ARXIV>
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                  </span>
              
                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/softrepa/SoftREPA" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                    </a>
                  </span>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser Carousel-->
<section class="hero teaser">

  <!-- <div class="columns is-centered" style="margin-top:-20px">
    <h1 class="is-size-3"> 
      <mark style="background: rgb(255, 255, 102)"> SoftREPA fixes CFG's issues with lower guidance scales, 
  </div>
  <div class="columns is-centered" style="margin-top:-10px">
    <h1 class="is-size-3"> 
      <mark style="background: rgb(255, 255, 102)"> improving text-to-image quality and invertibility.
      </mark></h1>
  </div>  -->

  <div class="hero-body">
    <div class="container">
    
      <div class="columns is-centered" style="margin-top:20px">
        <h1 class="is-size-4"> T2I Generation Results</h1>
        <h1 class="is-size-5", style="margin-top:4px"> &nbsp;(SD3) </h1>
      </div>  

      <div id="results-carousel" class="carousel results-carousel" style="margin-top:-25px">
       <div class="item">
        <!-- Your image here -->
        <img src="static/figures/t2igeneration-1.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          ‚Äú...sign that reads ‚ÄòOthello‚Äô.‚Äù
        </h2>
      </div>

      <div class="item">
        <!-- Your image here -->
        <img src="static/figures/t2igeneration-2.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          "A fire hydrant has some writing on its side."
        </h2>
      </div>

      <div class="item">
        <!-- Your image here -->
        <img src="static/figures/t2igeneration-3.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          "Knolling of a drawing tools."
        </h2>
      </div>

      <div class="item">
        <!-- Your image here -->
        <img src="static/figures/t2igeneration-4.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
         "Ethereal fantasy concept art of thunder god with hammer."
       </h2>
     </div>

     <div class="item">
      <!-- Your image here -->
      <img src="static/figures/t2igeneration-5.png" alt="MY ALT TEXT"/>
      <h2 class="subtitle has-text-centered">
        "A yellow and green object with a brown bird on top of it."
      </h2>
    </div>

  </div>


  <div class="hero-body">

  </div>
    <div class="container">
    
      <div class="columns is-centered" style="margin-top:20px">
        <h1 class="is-size-4"> Text Guided Image Editing Results</h1>
        <h1 class="is-size-5", style="margin-top:4px"> &nbsp;(SD3) </h1>
      </div>  

      <div id="results-carousel" class="carousel results-carousel" style="margin-top:-25px">
       <div class="item">
        <!-- Your image here -->
        <img src="static/figures/editing-1.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          "stone building‚Äù &rightarrow; ‚Äúwooden lighthouse"
        </h2>
      </div>
      
      <div class="item">
        <!-- Your image here -->
        <img src="static/figures/editing-2.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          ‚Äúyellow building‚Äù &rightarrow; ‚Äúred building, open door‚Äù
        </h2>
      </div>

      <div class="item">
        <!-- Your image here -->
        <img src="static/figures/editing-3.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          ‚Äúcar‚Äù &rightarrow; ‚Äúmotorcycle‚Äù
        </h2>
      </div>

      <div class="item">
        <!-- Your image here -->
        <img src="static/figures/editing-4.png" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          ‚Äúgreen and white caterpillar‚Äù  &rightarrow; ‚Äúblue and yellow butterfly‚Äù
       </h2>
     </div>

     <div class="item">
      <!-- Your image here -->
      <img src="static/figures/editing-5.png" alt="MY ALT TEXT"/>
      <h2 class="subtitle has-text-centered">
        ‚Äúrocky beach‚Äù &rightarrow; ‚Äúsandy beach‚Äù
      </h2>
    </div>

  </div>
</section>
<!-- End teaser video -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-sixths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">

          <p style="font-size:18px;">
            While recent advancements in generative modeling have significantly improved text-image alignment, some residual misalignment between text and image representations still remains. 
            Although many approaches have attempted to address this issue by fine-tuning models using various reward models, etc., we revisit the challenge from the perspective of representation alignment‚Äîan approach that has gained popularity with the success of REPresentation Alignment (REPA).
            We first argue that conventional text-to-image (T2I) diffusion models, typically trained on paired image and text data (i.e., positive pairs) by minimizing score matching or flow matching losses, is suboptimal from the standpoint of representation alignment. 
            Instead, a better alignment can be achieved through contrastive learning that leverages both positive and negative pairs.
            To achieve this efficiently even with pretrained models, we introduce a lightweight contrastive fine-tuning strategy called SoftREPA that uses soft text tokens. 
            This approach improves alignment with minimal computational overhead by adding fewer than 1M trainable parameters to the pretrained model. 
            Our theoretical analysis demonstrates that our method explicitly increases the mutual information between text and image representations, leading to enhanced semantic consistency. 
            Experimental results across text-to-image generation and text-guided image editing tasks validate the effectiveness of our approach in improving the semantic consistency of T2I generative models.
          </p>

        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Method -->
<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-sixths">
        <h2 class="title is-3">Method</h2>
        <div class="content has-text-justified">
          <img src="static/figures/main-figure.jpg" alt="rs_algorithm"/>
          <p style=" font-size:18px;">
            In SoftREPA, the soft tokens are optimized to contrastively match the score with positively conditioned predicted noise while repelling the score from negatively conditioned predicted noise. 
            This process implicitly sharpens the joint probability distribution of images and text by reducing the log probability of negatively paired conditions.
            The learnable soft tokens are prepended to the text features across the upper layers, with each layer‚Äôs previous soft tokens being replaced by the soft tokens of the current layer.

          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Method -->


<!-- Downstream Tasks -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-sxiths">
        <h2 class="title is-3">Experimental Results</h2>

        <h2 class="title is-4">1. T2I Generation</h2>
        <div class="content has-text-justified" style="margin-top:-15px; margin-bottom: 30px;">
          <img src="static/figures/exp1-results.jpg" alt="t2i_gen_w_interpolation"/>
          <table>
            <tr><th>Model</th><th>ImageReward ‚Üë</th><th>CLIP ‚Üë</th><th>HPS ‚Üë</th><th>LPIPS ‚Üì</th></tr>
            <tr><td>SD1.5</td><td>0.177</td><td>0.265</td><td>0.251</td><td>0.438</td></tr>
            <tr><td>SD1.5 + Ours</td><td><b>0.274</b></td><td><b>0.271</b></td><td>0.252</td><td>0.437</td></tr>
            <tr><td>SDXL</td><td>0.750</td><td>0.267</td><td>0.273</td><td>0.420</td></tr>
            <tr><td>SDXL + Ours</td><td><b>0.852</b></td><td><b>0.268</b></td><td><b>0.283</b></td><td>0.423</td></tr>
            <tr><td>SD3</td><td>0.942</td><td>0.263</td><td>0.280</td><td>0.424</td></tr>
            <tr><td>SD3 + Ours</td><td><b>1.085</b></td><td><b>0.269</b></td><td><b>0.289</b></td><td>0.428</td></tr>
          </table>
          <p style="margin-top:5px; margin-bottom: 10px; font-size:18px;">
            We evaluate SoftREPA across <b>diffusion</b> and <b>rectified flow</b> models, and across <b>UNet</b> and <b>Transformer</b> architectures.
            Our approach consistently improves alignment and image quality on all fronts, demonstrating strong generalization.
          </p>
        </div>
        
        <h2 class="title is-4"> 2. Text Guided Image Editing </h2>
        <div class="content has-text-justified" style="margin-top:-15px; margin-bottom: 30px;">
          <img src="static/figures/exp2-editing.jpg" alt="inv_algorithm" style="margin-bottom:20px">
          <table>
            <tr><th>Model</th><th>Dataset</th><th>ImageReward ‚Üë</th><th>CLIP ‚Üë</th><th>HPS ‚Üë</th><th>LPIPS ‚Üì</th></tr>
            <tr><td>FlowEdit</td><td>DIV2K</td><td>0.380</td><td>0.260</td><td>0.255</td><td>0.154</td></tr>
            <tr><td>FlowEdit + Ours</td><td>DIV2K</td><td><b>0.466</b></td><td><b>0.263</b></td><td><b>0.260</b></td><td><b>0.149</b></td></tr>
            <tr><td>FlowEdit</td><td>Cat2Dog</td><td>0.937</td><td>0.225</td><td>0.266</td><td>0.199</td></tr>
            <tr><td>FlowEdit + Ours</td><td>Cat2Dog</td><td><b>1.111</b></td><td><b>0.226</b></td><td><b>0.269</b></td><td><b>0.173</b></td></tr>
          </table>          
          <p style="margin-top:5px; margin-bottom: 30px; font-size: 18px;">
            SoftREPA boosts alignment and visual quality in editing tasks with fewer steps and lower CFG scale.
          </p>
        </div>

      <h2 class="title is-4" style="margin-top:-20px;"> Key Contributions</h2>
      <div class="content has-text-justified">
        <ul>
          <li>üìå <b>SoftREPA</b> introduces soft tokens trained with contrastive learning.</li>
          <li>‚ö° Requires < 1M trainable parameters, minimal compute cost.</li>
          <li>üí° Improves semantic alignment in generation and editing without model re-training.</li>
        </ul>
      </div> 

      </div>
    </div>
  </div>
</section>

<!--BibTex citation -->
  <!-- <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>BibTex Code Here</code></pre>
    </div>
</section> -->
<!--End BibTex citation -->

  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the¬†<a href="https://nerfies.github.io" target="_blank">Nerfies</a>¬†project page.
            You are free to borrow the of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html> 
